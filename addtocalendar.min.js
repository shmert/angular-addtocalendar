/**
 * angular-addtocalendar v1.1.2
 * An AngularJS directive for adding an event to calendar apps.
 *
 * Controller and directive.
 */
"use strict"
angular.module("jshor.angular-addtocalendar",[]).config(["$compileProvider",function(e){e.aHrefSanitizationWhitelist(/^\s*(http(s)?|data):/)}]).controller("AddtocalendarCtrl",["$scope",function(e){function n(n){function t(e,n){return e&&e.length?o(e.replace(/\n/g,"\\n"),n):e}function o(e,n){return n||(n=75),!e||e.length<=n?e:e.substring(0,n).replace(/\n/g,"\\n")+"\r\n "+o(e.substring(n),75)}var a=["BEGIN:VCALENDAR","VERSION:2.0","BEGIN:VEVENT","CLASS:PUBLIC","DESCRIPTION:"+t(e.description,62),"DTSTART:"+e.startDate,"DTEND:"+e.endDate,"LOCATION:"+t(e.location,64),"SUMMARY:"+t(e.title,66),"TRANSP:TRANSPARENT","END:VEVENT","END:VCALENDAR"]
return a.join("\n")}function t(){var n="http://calendar.yahoo.com/?v=60&view=d&type=20"
return n+="&title="+encodeURIComponent(e.title),n+="&st="+encodeURIComponent(e.startDate)+"&et="+encodeURIComponent(e.endDate),n+="&desc="+encodeURIComponent(e.description),n+="&in_loc="+encodeURIComponent(e.location)}function o(){var n="https://www.google.com/calendar/render?action=TEMPLATE"
return n+="&text="+encodeURIComponent(e.title),n+="&dates="+encodeURIComponent(e.startDate)+"/"+encodeURIComponent(e.endDate),n+="&details="+encodeURIComponent(e.description),n+="&location="+encodeURIComponent(e.location)}function a(){var n="http://calendar.live.com/calendar/calendar.aspx?rru=addevent"
return n+="&summary="+encodeURIComponent(e.title),n+="&dtstart="+encodeURIComponent(e.startDate)+"&dtend="+encodeURIComponent(e.endDate),n+="&description="+encodeURIComponent(e.description),n+="&location="+encodeURIComponent(e.location)}function r(){var t=e.title.replace(/[^\w ]+/g,"")+".ics"
download(n(),t,"application/octet-stream")}e.description=e.description||"",e.calendarUrl={microsoft:a(),google:o(),yahoo:t(),icalendar:n(),dlIcal:r}}]).directive("addtocalendar",function(){return{restrict:"E",scope:{startDate:"@",endDate:"@",title:"@",description:"@",location:"@",className:"@",btnText:"@"},controller:"AddtocalendarCtrl",template:'      <div class="btn-group" uib-dropdown on-toggle="toggled(open)">	      <span	      	ng-class="className || \'btn btn-sm btn-default uib-dropdown-toggle\'"	      	uib-dropdown-toggle>	      	{{btnText || \'Add to calendar\'}} <span class="caret"></span>	      </span>	      <ul class="uib-dropdown-menu">		      <li><a ng-click="calendarUrl.dlIcal()">iCalendar</a></li>		      <li><a href="{{calendarUrl.google}}" target="_blank">Google Calendar</a></li>		      <li><a ng-click="calendarUrl.dlIcal()">Outlook</a></li>		      <li><a href="{{calendarUrl.yahoo}}" target="_blank">Yahoo! Calendar</a></li>		      <li><a href="{{calendarUrl.microsoft}}" target="_blank">Microsoft Calendar</a></li>	      </ul>      </div>'}})
